<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VK-E2E - Music</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Special+Gothic+Expanded+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles/music.css">
</head>
<body>
    <div class="drag-region"></div>
    <canvas id="meshGradientCanvas" class="mesh-gradient-canvas"></canvas>


    <div class="sidebar-menu" id="sidebarMenu">
        <div class="sidebar-logo">
            <img src="../img/icons/logo-menu.svg" alt="Logo" onerror="this.style.display='none'">
        </div>
        <div class="sidebar-buttons">
            <button id="searchBtn">Search</button>
            <button id="wallBtn">Wall</button>
            <button id="musicBtn">Music</button>
            <button id="settingsBtn">Settings</button>
            <button id="aboutBtn">About</button>
        </div>
        <div class="sidebar-version">
            version 0.1 BETA
        </div>
    </div>

    <!-- Menu Toggle Button -->
    <div class="menu-toggle" id="menuToggle">
        <img src="../img/icons/menu.svg" alt="Menu" onerror="this.style.display='none'">
    </div>

    <!-- Визуализатор с картинкой -->
    <div class="visualizer-container" id="visualizerContainer">
        <img id="visualizerImage" class="visualizer-image" src="../img/icons/aether_play_w.png" alt="Player">
        <canvas id="visualizerCanvas" style="display: none;"></canvas>
    </div>

    <!-- Main Content -->
    <div class="music-content">
        <div class="playlist-container" id="playlistContainer">
            <div class="playlist-header">
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Поиск треков...">
                <button id="performSearch">Найти</button>
                <div id="searchResults" class="search-results hidden"></div>
            </div>
            <div class="buttons-group">
                <button class="my-tracks-btn" id="myTracksBtn">Мои треки</button>
                <button class="shuffle-btn" id="shuffleBtn" disabled>Перемешать</button>
            </div>
            </div>
        </div>
        
        <!-- My Tracks List -->
        <div class="my-tracks-list hidden" id="myTracksList">
            <div class="my-tracks-container" id="myTracksContainer">
                <!-- Треки будут добавлены через JS -->
            </div>
        </div>
    </div>

    <!-- Fixed Player Bottom -->
    <div class="player-fixed">
        <div class="player-container">
            <!-- Current Track Info -->
            <div class="current-track-info">
                <img class="current-cover" id="currentCover" src="" alt="Cover" style="display: none;">
                <div class="current-details">
                    <div class="current-title" id="currentTitle">Выберите трек</div>
                    <div class="current-artist" id="currentArtist">-</div>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-bar" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="time-info">
                    <span id="currentTime">0:00</span>
                    <span id="totalTime">0:00</span>
                </div>
            </div>

            <!-- Player Controls -->
            <div class="player-controls">
                
                <button class="like-btn" id="likeBtn" title="Like">
                    <svg viewBox="0 0 24 24" id="likeIcon">
                        <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                    </svg>
                </button>

                <button class="control-btn" id="prevBtn" title="Previous">
                    <svg viewBox="0 0 24 24">
                        <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/>
                    </svg>
                </button>
                
                <button class="control-btn play" id="playBtn" title="Play">
                    <svg viewBox="0 0 24 24" id="playIcon">
                        <path d="M8 5v14l11-7z"/>
                    </svg>
                    <svg viewBox="0 0 24 24" id="pauseIcon" style="display: none;">
                        <path d="M6 4h4v16H6zm8 0h4v16h-4z"/>
                    </svg>
                </button>
                
                <button class="control-btn" id="nextBtn" title="Next">
                    <svg viewBox="0 0 24 24">
                        <path d="M16 18h2V6h-2zm-11-7l8.5-6v12z"/>
                    </svg>
                </button>
                
                <!-- Volume Control -->
                <div class="volume-control" id="volumeControl">
                    <button class="control-btn volume-btn" id="volumeBtn" title="Volume">
                        <svg viewBox="0 0 24 24" id="volumeIcon">
                            <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/>
                        </svg>
                        <svg viewBox="0 0 24 24" id="volumeMuteIcon" style="display: none;">
                            <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
                        </svg>
                    </button>
                    <div class="volume-slider-container" id="volumeSliderContainer">
                        <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="100" orient="vertical">
                        <div class="volume-percentage" id="volumePercentage">100%</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="../utils/global-audio-manager.js"></script>
    <script src="../utils/mesh-gradient.js"></script>
    <script src="../utils/audio-visualizer.js"></script>
    <script src="../utils/sidebar-menu.js"></script>
    <script src="../utils/music-player.js"></script>
    <script>
        // Дополнительный обработчик для возврата в меню
        document.getElementById('menuToggle').addEventListener('click', function(e) {
            e.stopPropagation();
        });

        // Обработчики боковых кнопок меню
        document.getElementById('searchBtn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });

        document.getElementById('wallBtn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });

        document.getElementById('settingsBtn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });

        document.getElementById('aboutBtn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
    </script>
</body>
</html>